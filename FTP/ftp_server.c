/*
 * This is sample code generated by rpcgen.
 * These are only templates and you can use them
 * as a guideline for developing your own functions.
 */

#include "ftp.h"

ftp_file *
read_file_1_svc(ftp_req *argp, struct svc_req *rqstp)
{
	static ftp_file result;
  result.name = malloc(sizeof(char)*512);
	int packageSize = (argp->length > 512)? 512 : argp->length;
  result.data.data_val = malloc(sizeof(char)*packageSize);
  strncpy(result.name, argp->name, 512);

  FILE* f = fopen(argp->name, "rb");
  fseek(f, argp->pos, SEEK_SET);
  result.data.data_len = fread(result.data.data_val, 1, packageSize, f);
  fclose(f);

	return &result;
}

int *
write_file_1_svc(ftp_file *argp, struct svc_req *rqstp)
{
	static int  result;

  FILE* f = fopen(argp->name, "ab");
  fseek(f, argp->pos, SEEK_SET);
  result = fwrite(argp->data.data_val, 1, argp->data.data_len, f);
  fclose(f);

	return &result;
}
